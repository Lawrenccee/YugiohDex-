function setListenerDD(b){b.addEventListener("mouseover",function(){modalImageDD.setAttribute("src",b.getAttribute("src")),attackValueDD.innerHTML=b.getAttribute("attack"),defenseValueDD.innerHTML=b.getAttribute("defense"),descriptionValueDD.innerHTML=b.getAttribute("description"),nameValueDD.innerHTML=b.getAttribute("name")})}function createCardViewDD(h){const g=document.createElement("div");g.className="col-sm-2 col-xs-6";const l=document.createElement("button");l.className="btn btn-link",l.setAttribute("data-target","#card_detail_modal"),l.setAttribute("data-toggle","modal"),g.appendChild(l);const k=document.createElement("img");k.className="img-responsive";var j=h.storageURL,i=h.name;return k.setAttribute("name",i),k.setAttribute("attack",h.attack),k.setAttribute("defense",h.defense),k.setAttribute("description",h.description),k.setAttribute("src",j),k.setAttribute("alt",i),setListenerDD(k),l.appendChild(k),g}function uid(){function b(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return b()+b()+"-"+b()+"-"+b()+"-"+b()+"-"+b()+b()+b()}function setEditListener(){editButton.addEventListener("mouseover",function(){localStorage.setItem("cardLength",Object.keys(userCards).length);var e=-1;for(var d in userCards){e++,localStorage.setItem(""+e,userCards[d])}var f=""+e;localStorage.setItem("index",f),localStorage.setItem("willEdit",!0),localStorage.setItem("editDeckName",editDeckName),localStorage.setItem("editDeckID",editID)})}var dbDeckRef=firebase.database().ref().child("decks"),dbCardsRef=firebase.database().ref().child("cards");const modalImageDD=document.getElementById("modalImageDD"),attackValueDD=document.getElementById("attackValueDD"),defenseValueDD=document.getElementById("defenseValueDD"),descriptionValueDD=document.getElementById("descriptionValueDD"),nameValueDD=document.getElementById("nameValueDD");var isUser=localStorage.getItem("isUser");const editButton=document.getElementById("editButton"),deleteButton=document.getElementById("deleteButton");1!=isUser&&"true"!=isUser||(editButton.setAttribute("style","visibility:visible"),deleteButton.setAttribute("style","visibility:visible"));const deckID=document.getElementById("deckID");deckID.innerHTML=localStorage.getItem("deckName");var editDeckName=localStorage.getItem("deckName"),editID=localStorage.getItem("deckID"),viewID=localStorage.getItem("viewDeckID");const cardGalleryRow=document.getElementById("cardGalleryRow"),userCards={};firebase.database().ref("/decks/").once("value").then(function(h){var g=h.val();for(var l in g){var k=g[l];if(k.deckName==deckID.textContent){var j=k.cards;for(var i in j){userCards[i]=j[i],firebase.database().ref("/cards/"+j[i]).once("value").then(function(d){var c=d.val();cardGalleryRow.appendChild(createCardViewDD(c))})}}}setEditListener()});const commentBtn=document.getElementById("commentBtn"),commentsList=document.getElementById("commentList"),commentsRef=firebase.database().ref().child("/decks/"+viewID+"/comments/");commentsRef.on("child_added",function(i){var h=i.val();const n=document.createElement("li");n.className="list-group-item";const m=document.createElement("blockquote");m.innerHTML=h.content;const l=document.createElement("cite");l.innerHTML=h.email;const k=document.createElement("p");k.innerHTML=h.date,n.setAttribute("email",h.email),n.appendChild(m),n.appendChild(l),n.appendChild(k);const j=document.createElement("input");j.setAttribute("type","button"),j.setAttribute("class","btn btn-danger"),j.setAttribute("value","delete"),j.addEventListener("click",function(){var a={},d=i.key+"";a["/decks/"+viewID+"/comments/"+d]=null,firebase.database().ref().update(a)}),n.appendChild(j),commentsList.appendChild(n)}),commentsRef.on("child_removed",function(e){console.log("Removing from commentsList");for(var d=e.val().email,f=0;f<commentsList.childNodes.length;f++){"li"==commentsList.childNodes[f].nodeName.toLowerCase()&&commentsList.childNodes[f].getAttribute("email")==d&&commentsList.removeChild(commentsList.childNodes[f])}}),deleteButton.addEventListener("click",function(){if(null!=editID){var d=editID,c={};c["/decks/"+d]=null,c["/users/"+firebase.auth().currentUser.uid+"/decks/"+d]=null,firebase.database().ref().update(c),alert("Your deck was successfully deleted")}}),commentBtn.addEventListener("click",function(){if(!firebase.auth().currentUser){return void alert("Account requried to post content. Please create account or log in.")}var t=uid(),s="",r="",q=document.getElementById("comments");null!=firebase.auth().currentUser&&(s=firebase.auth().currentUser.email,r=firebase.auth().currentUser.uid);var p=q.value,o=new Date,n=o.getDate(),m=o.getMonth()+1,l=o.getFullYear();n<10&&(n="0"+n),m<10&&(m="0"+m),o=m+"/"+n+"/"+l;var k={content:p,date:o,email:s,uid:r};commentsRef.child(t).set(k),q.value=""});